{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.4", "generated_at": "2024-08-06T00:26:18.041850Z", "invocation_id": "c0bb610d-1a93-4544-9494-04ec290c4d15", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.228195Z", "completed_at": "2024-08-06T00:26:16.236907Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.237808Z", "completed_at": "2024-08-06T00:26:16.237822Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02380990982055664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__address_discounts_tmp", "compiled": true, "compiled_code": "select *\nfrom \"postgres\".\"recharge_integration_tests_03\".\"address_discounts_data\"", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__address_discounts_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.233384Z", "completed_at": "2024-08-06T00:26:16.237221Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.238336Z", "completed_at": "2024-08-06T00:26:16.238345Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.023579120635986328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__address_tmp", "compiled": true, "compiled_code": "select *\nfrom \"postgres\".\"recharge_integration_tests_03\".\"address_data\"", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__address_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.230933Z", "completed_at": "2024-08-06T00:26:16.237509Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.238850Z", "completed_at": "2024-08-06T00:26:16.238854Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02449798583984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__address_shipping_line_tmp", "compiled": true, "compiled_code": "select *\nfrom \"postgres\".\"recharge_integration_tests_03\".\"address_shipping_line_data\"", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__address_shipping_line_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.241610Z", "completed_at": "2024-08-06T00:26:16.250015Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.250779Z", "completed_at": "2024-08-06T00:26:16.250785Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010662078857421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__charge_discount_tmp", "compiled": true, "compiled_code": "select *\nfrom \"postgres\".\"recharge_integration_tests_03\".\"charge_discount_data\"", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_discount_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.246724Z", "completed_at": "2024-08-06T00:26:16.250322Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.251222Z", "completed_at": "2024-08-06T00:26:16.251225Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010582923889160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__charge_order_attribute_tmp", "compiled": true, "compiled_code": "select *\nfrom \"postgres\".\"recharge_integration_tests_03\".\"charge_order_attribute_data\"", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_order_attribute_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.244109Z", "completed_at": "2024-08-06T00:26:16.250548Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.251611Z", "completed_at": "2024-08-06T00:26:16.251616Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011197805404663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__charge_line_item_tmp", "compiled": true, "compiled_code": "select *\nfrom \"postgres\".\"recharge_integration_tests_03\".\"charge_line_item_data\"", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_line_item_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.254481Z", "completed_at": "2024-08-06T00:26:16.262244Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.263142Z", "completed_at": "2024-08-06T00:26:16.263150Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010313034057617188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__charge_shipping_line_tmp", "compiled": true, "compiled_code": "select *\nfrom \"postgres\".\"recharge_integration_tests_03\".\"charge_shipping_line_data\"", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_shipping_line_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.259448Z", "completed_at": "2024-08-06T00:26:16.262588Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.263626Z", "completed_at": "2024-08-06T00:26:16.263633Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010275125503540039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__charge_tmp", "compiled": true, "compiled_code": "select *\nfrom \"postgres\".\"recharge_integration_tests_03\".\"charge_data\"", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.256877Z", "completed_at": "2024-08-06T00:26:16.262858Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.264087Z", "completed_at": "2024-08-06T00:26:16.264091Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011034965515136719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__charge_tax_line_tmp", "compiled": true, "compiled_code": "\nselect *\nfrom \"postgres\".\"recharge_integration_tests_03\".\"charge_tax_line_data\"", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_tax_line_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.271952Z", "completed_at": "2024-08-06T00:26:16.275550Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.276334Z", "completed_at": "2024-08-06T00:26:16.276342Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010504961013793945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__discount_tmp", "compiled": true, "compiled_code": "select *\nfrom \"postgres\".\"recharge_integration_tests_03\".\"discount_data\"", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__discount_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.266776Z", "completed_at": "2024-08-06T00:26:16.275851Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.276784Z", "completed_at": "2024-08-06T00:26:16.276788Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011422872543334961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__checkout_tmp", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"postgres\".\"recharge_integration_tests_03\".\"checkout_data\"", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__checkout_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.269327Z", "completed_at": "2024-08-06T00:26:16.276083Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.277167Z", "completed_at": "2024-08-06T00:26:16.277170Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01151585578918457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__customer_tmp", "compiled": true, "compiled_code": "select *\nfrom \"postgres\".\"recharge_integration_tests_03\".\"customer_data\"", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__customer_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.283002Z", "completed_at": "2024-08-06T00:26:16.290672Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.291176Z", "completed_at": "2024-08-06T00:26:16.291184Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.012469053268432617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__order_line_item_tmp", "compiled": true, "compiled_code": "select *\nfrom \"postgres\".\"recharge_integration_tests_03\".\"order_line_item_data\"", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__order_line_item_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.280178Z", "completed_at": "2024-08-06T00:26:16.290921Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.291620Z", "completed_at": "2024-08-06T00:26:16.291624Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013189077377319336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__one_time_product_tmp", "compiled": true, "compiled_code": "\nselect *\nfrom \"postgres\".\"recharge_integration_tests_03\".\"one_time_product_data\"", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__one_time_product_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.285189Z", "completed_at": "2024-08-06T00:26:16.292031Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.293134Z", "completed_at": "2024-08-06T00:26:16.293138Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014061927795410156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__order_tmp", "compiled": true, "compiled_code": "select *\nfrom\n\"postgres\".\"recharge_integration_tests_03\".\"orders_data\"", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__order_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.301812Z", "completed_at": "2024-08-06T00:26:16.303069Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.303456Z", "completed_at": "2024-08-06T00:26:16.303465Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008562088012695312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.recharge_integration_tests.address_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.295314Z", "completed_at": "2024-08-06T00:26:16.303901Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.304880Z", "completed_at": "2024-08-06T00:26:16.304889Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011439085006713867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__subscription_history_tmp", "compiled": true, "compiled_code": "select *\nfrom \"postgres\".\"recharge_integration_tests_03\".\"subscription_history_data\"", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__subscription_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.298133Z", "completed_at": "2024-08-06T00:26:16.304228Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.305341Z", "completed_at": "2024-08-06T00:26:16.305347Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01158595085144043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__subscription_tmp", "compiled": true, "compiled_code": "select *\nfrom \"postgres\".\"recharge_integration_tests_03\".\"subscription_data\"", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__subscription_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.308255Z", "completed_at": "2024-08-06T00:26:16.309494Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.310441Z", "completed_at": "2024-08-06T00:26:16.310448Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004711151123046875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.recharge_integration_tests.address_discounts_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.310887Z", "completed_at": "2024-08-06T00:26:16.312087Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.314089Z", "completed_at": "2024-08-06T00:26:16.314097Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007253885269165039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.recharge_integration_tests.address_shipping_line_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.312361Z", "completed_at": "2024-08-06T00:26:16.313519Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.314572Z", "completed_at": "2024-08-06T00:26:16.314577Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.006808042526245117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.recharge_integration_tests.charge_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.316688Z", "completed_at": "2024-08-06T00:26:16.318864Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.319597Z", "completed_at": "2024-08-06T00:26:16.319602Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004729032516479492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.recharge_integration_tests.charge_discount_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.319984Z", "completed_at": "2024-08-06T00:26:16.321154Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.323115Z", "completed_at": "2024-08-06T00:26:16.323123Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007224082946777344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.recharge_integration_tests.charge_line_item_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.321455Z", "completed_at": "2024-08-06T00:26:16.322513Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.323593Z", "completed_at": "2024-08-06T00:26:16.323597Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007302045822143555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.recharge_integration_tests.charge_order_attribute_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.325640Z", "completed_at": "2024-08-06T00:26:16.326922Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.327580Z", "completed_at": "2024-08-06T00:26:16.327585Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0037119388580322266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.recharge_integration_tests.charge_shipping_line_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.327924Z", "completed_at": "2024-08-06T00:26:16.328964Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.331099Z", "completed_at": "2024-08-06T00:26:16.331107Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0060520172119140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.recharge_integration_tests.charge_tax_line_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.329235Z", "completed_at": "2024-08-06T00:26:16.330406Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.331628Z", "completed_at": "2024-08-06T00:26:16.331632Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.006269931793212891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.recharge_integration_tests.checkout_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.333666Z", "completed_at": "2024-08-06T00:26:16.335754Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.336409Z", "completed_at": "2024-08-06T00:26:16.336415Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004478931427001953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.recharge_integration_tests.customer_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.336797Z", "completed_at": "2024-08-06T00:26:16.337928Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.339778Z", "completed_at": "2024-08-06T00:26:16.339782Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006707906723022461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.recharge_integration_tests.discount_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.338191Z", "completed_at": "2024-08-06T00:26:16.339324Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.340162Z", "completed_at": "2024-08-06T00:26:16.340165Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.006784915924072266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.recharge_integration_tests.one_time_product_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.342121Z", "completed_at": "2024-08-06T00:26:16.343263Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.343907Z", "completed_at": "2024-08-06T00:26:16.343910Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003498077392578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.recharge_integration_tests.order_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.344238Z", "completed_at": "2024-08-06T00:26:16.345217Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.346880Z", "completed_at": "2024-08-06T00:26:16.346890Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005404949188232422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.recharge_integration_tests.order_line_item_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.345424Z", "completed_at": "2024-08-06T00:26:16.346361Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.347403Z", "completed_at": "2024-08-06T00:26:16.347407Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005578279495239258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.recharge_integration_tests.orders_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.349117Z", "completed_at": "2024-08-06T00:26:16.351382Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.352167Z", "completed_at": "2024-08-06T00:26:16.352173Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004508018493652344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.recharge_integration_tests.subscription_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.352555Z", "completed_at": "2024-08-06T00:26:16.353618Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.363675Z", "completed_at": "2024-08-06T00:26:16.363686Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01509404182434082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.recharge_integration_tests.subscription_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.216147Z", "completed_at": "2024-08-06T00:26:16.571947Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.572325Z", "completed_at": "2024-08-06T00:26:16.572333Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3907802104949951, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge.int_recharge__calendar_spine", "compiled": true, "compiled_code": "with spine as (\n    \n    \n    \n        \n            \n            \n            \n        \n\n    \n    \n\n    \n    \n    \n\n\n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 61\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    cast('2022-09-08'as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= cast('2022-11-08'as date)\n\n)\n\nselect * from filtered\n\n\n)\n\nselect *\nfrom spine", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge\".\"int_recharge__calendar_spine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.353881Z", "completed_at": "2024-08-06T00:26:16.605266Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.605905Z", "completed_at": "2024-08-06T00:26:16.605910Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2818338871002197, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__address_discounts", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__address_discounts_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    address_id\n    \n as \n    \n    address_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    index\n    \n as \n    \n    index\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        id as discount_id,\n        address_id,\n        index\n\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__address_discounts\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.405881Z", "completed_at": "2024-08-06T00:26:16.669827Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.670057Z", "completed_at": "2024-08-06T00:26:16.670063Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.329575777053833, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__address_shipping_line", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__address_shipping_line_tmp\"\n),\n\nfields as (\n    \n    select\n        \n    \n    \n    address_id\n    \n as \n    \n    address_id\n    \n, \n    \n    \n    index\n    \n as \n    \n    index\n    \n, \n    \n    \n    price\n    \n as \n    \n    price\n    \n, \n    \n    \n    code\n    \n as \n    \n    code\n    \n, \n    \n    \n    title\n    \n as \n    \n    title\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        address_id,\n        index,\n        price,\n        code,\n        title\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__address_shipping_line\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.365778Z", "completed_at": "2024-08-06T00:26:16.682692Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.683000Z", "completed_at": "2024-08-06T00:26:16.683008Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3440968990325928, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__address", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__address_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    customer_id\n    \n as \n    \n    customer_id\n    \n, \n    \n    \n    first_name\n    \n as \n    \n    first_name\n    \n, \n    \n    \n    last_name\n    \n as \n    \n    last_name\n    \n, \n    \n    \n    address_1\n    \n as \n    \n    address_1\n    \n, \n    \n    \n    address_2\n    \n as \n    \n    address_2\n    \n, \n    \n    \n    city\n    \n as \n    \n    city\n    \n, \n    \n    \n    province\n    \n as \n    \n    province\n    \n, \n    \n    \n    country_code\n    \n as \n    \n    country_code\n    \n, \n    cast(null as TEXT) as \n    \n    country\n    \n , \n    \n    \n    zip\n    \n as \n    \n    zip\n    \n, \n    \n    \n    company\n    \n as \n    \n    company\n    \n, \n    \n    \n    phone\n    \n as \n    \n    phone\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    cast(null as TEXT) as \n    \n    payment_method_id\n    \n \n\n\n    from base\n),\n\nfinal as (\n\n    select\n        id as address_id,\n        customer_id,\n        first_name,\n        last_name,\n        cast(created_at as timestamp) as address_created_at,\n        cast(updated_at as timestamp) as address_updated_at,\n        address_1 as address_line_1,\n        address_2 as address_line_2,\n        city,\n        province,\n        zip,\n        country_code,\n        country,\n        company,\n        phone,\n        payment_method_id\n\n        \n\n\n\n\n\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__address\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.606510Z", "completed_at": "2024-08-06T00:26:16.849497Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.849824Z", "completed_at": "2024-08-06T00:26:16.849831Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2656834125518799, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__charge_discount", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_discount_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    charge_id\n    \n as \n    \n    charge_id\n    \n, \n    \n    \n    index\n    \n as \n    \n    index\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    code\n    \n as \n    \n    code\n    \n, \n    \n    \n    value\n    \n as \n    \n    value\n    \n, \n    \n    \n    value_type\n    \n as \n    \n    value_type\n    \n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        charge_id,\n        index,\n        id as discount_id, \n        code,\n        cast(value as float) as discount_value,\n        value_type\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_discount\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.632015Z", "completed_at": "2024-08-06T00:26:16.864993Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.865267Z", "completed_at": "2024-08-06T00:26:16.865274Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2546970844268799, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__charge_order_attribute", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_order_attribute_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    charge_id\n    \n as \n    \n    charge_id\n    \n, \n    \n    \n    index\n    \n as \n    \n    index\n    \n, \n    \n    \n    order_attribute\n    \n as \n    \n    order_attribute\n    \n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        charge_id,\n        index,\n        order_attribute\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_order_attribute\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.696512Z", "completed_at": "2024-08-06T00:26:16.949852Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.950124Z", "completed_at": "2024-08-06T00:26:16.950132Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.2786259651184082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__charge_line_item", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_line_item_tmp\"\n),\n\nfields as (\n    \n    select\n        \n    \n    \n    charge_id\n    \n as \n    \n    charge_id\n    \n, \n    \n    \n    index\n    \n as \n    \n    index\n    \n, \n    \n    \n    variant_title\n    \n as \n    \n    variant_title\n    \n, \n    \n    \n    title\n    \n as \n    \n    title\n    \n, \n    \n    \n    quantity\n    \n as \n    \n    quantity\n    \n, \n    \n    \n    grams\n    \n as \n    \n    grams\n    \n, \n    \n    \n    total_price\n    \n as \n    \n    total_price\n    \n, \n    \n    \n    unit_price\n    \n as \n    \n    unit_price\n    \n, \n    \n    \n    tax_due\n    \n as \n    \n    tax_due\n    \n, \n    \n    \n    taxable\n    \n as \n    \n    taxable\n    \n, \n    \n    \n    taxable_amount\n    \n as \n    \n    taxable_amount\n    \n, \n    \n    \n    unit_price_includes_tax\n    \n as \n    \n    unit_price_includes_tax\n    \n, \n    \n    \n    sku\n    \n as \n    \n    sku\n    \n, \n    \n    \n    external_product_id_ecommerce\n    \n as \n    \n    external_product_id_ecommerce\n    \n, \n    \n    \n    external_variant_id_ecommerce\n    \n as \n    \n    external_variant_id_ecommerce\n    \n, \n    \n    \n    vendor\n    \n as \n    \n    vendor\n    \n, \n    \n    \n    purchase_item_id\n    \n as \n    \n    purchase_item_id\n    \n, \n    \n    \n    purchase_item_type\n    \n as \n    \n    purchase_item_type\n    \n\n\n\n    from base\n),\n\nfinal as (\n    \n    select\n        charge_id,\n        index,\n        vendor,\n        title,\n        variant_title,\n        sku,\n        grams,\n        quantity,\n        cast(total_price as float) as total_price,\n        unit_price,\n        tax_due,\n        taxable,\n        taxable_amount,\n        unit_price_includes_tax,\n        external_product_id_ecommerce,\n        external_variant_id_ecommerce,\n        purchase_item_id,\n        purchase_item_type\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_line_item\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.709823Z", "completed_at": "2024-08-06T00:26:16.985315Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:16.985578Z", "completed_at": "2024-08-06T00:26:16.985584Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.30220794677734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__charge_shipping_line", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_shipping_line_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    charge_id\n    \n as \n    \n    charge_id\n    \n, \n    \n    \n    index\n    \n as \n    \n    index\n    \n, \n    \n    \n    price\n    \n as \n    \n    price\n    \n, \n    \n    \n    code\n    \n as \n    \n    code\n    \n, \n    \n    \n    title\n    \n as \n    \n    title\n    \n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        charge_id,\n        index,\n        price,\n        code,\n        title\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_shipping_line\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.887546Z", "completed_at": "2024-08-06T00:26:17.176417Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.176779Z", "completed_at": "2024-08-06T00:26:17.176787Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.31486988067626953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__charge_tax_line", "compiled": true, "compiled_code": "\nwith base as (\n\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_tax_line_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    charge_id\n    \n as \n    \n    charge_id\n    \n, \n    \n    \n    index\n    \n as \n    \n    index\n    \n, \n    \n    \n    price\n    \n as \n    \n    price\n    \n, \n    \n    \n    rate\n    \n as \n    \n    rate\n    \n, \n    \n    \n    title\n    \n as \n    \n    title\n    \n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        charge_id,\n        index,\n        price,\n        rate,\n        title\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_tax_line\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.872790Z", "completed_at": "2024-08-06T00:26:17.177025Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.177312Z", "completed_at": "2024-08-06T00:26:17.177316Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3362009525299072, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__charge", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    address_id\n    \n as \n    \n    address_id\n    \n, \n    \n    \n    customer_id\n    \n as \n    \n    customer_id\n    \n, \n    \n    \n    customer_hash\n    \n as \n    \n    customer_hash\n    \n, \n    \n    \n    note\n    \n as \n    \n    note\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n, \n    \n    \n    processed_at\n    \n as \n    \n    processed_at\n    \n, \n    \n    \n    scheduled_at\n    \n as \n    \n    scheduled_at\n    \n, \n    \n    \n    orders_count\n    \n as \n    \n    orders_count\n    \n, \n    \n    \n    external_order_id_ecommerce\n    \n as \n    \n    external_order_id_ecommerce\n    \n, \n    \n    \n    subtotal_price\n    \n as \n    \n    subtotal_price\n    \n, \n    \n    \n    tags\n    \n as \n    \n    tags\n    \n, \n    \n    \n    tax_lines\n    \n as \n    \n    tax_lines\n    \n, \n    \n    \n    total_discounts\n    \n as \n    \n    total_discounts\n    \n, \n    \n    \n    total_line_items_price\n    \n as \n    \n    total_line_items_price\n    \n, \n    \n    \n    total_price\n    \n as \n    \n    total_price\n    \n, \n    \n    \n    total_tax\n    \n as \n    \n    total_tax\n    \n, \n    \n    \n    total_weight_grams\n    \n as \n    \n    total_weight_grams\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    total_refunds\n    \n as \n    \n    total_refunds\n    \n, \n    \n    \n    external_transaction_id_payment_processor\n    \n as \n    \n    external_transaction_id_payment_processor\n    \n, \n    \n    \n    email\n    \n as \n    \n    email\n    \n, \n    \n    \n    payment_processor\n    \n as \n    \n    payment_processor\n    \n, \n    cast(null as boolean) as \n    \n    has_uncommitted_changes\n    \n , \n    \n    \n    retry_date\n    \n as \n    \n    retry_date\n    \n, \n    \n    \n    error_type\n    \n as \n    \n    error_type\n    \n, \n    \n    \n    error\n    \n as \n    \n    error\n    \n, \n    \n    \n    charge_attempts\n    \n as \n    \n    charge_attempts\n    \n, \n    \n    \n    external_variant_id_not_found\n    \n as \n    \n    external_variant_id_not_found\n    \n, \n    \n    \n    client_details_browser_ip\n    \n as \n    \n    client_details_browser_ip\n    \n, \n    \n    \n    client_details_user_agent\n    \n as \n    \n    client_details_user_agent\n    \n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        id as charge_id,\n        customer_id,\n        customer_hash,\n        email,\n        cast(created_at as timestamp) as charge_created_at,\n        type as charge_type,\n        status as charge_status,\n        cast(updated_at as timestamp) as charge_updated_at,\n        note,\n        subtotal_price,\n        tax_lines,\n        total_discounts,\n        total_line_items_price,\n        total_tax,\n        cast(total_price as float) as total_price,\n        total_refunds,\n        total_weight_grams,\n        cast(scheduled_at as timestamp) as charge_scheduled_at,\n        cast(processed_at as timestamp) as charge_processed_at,\n        payment_processor,\n        external_transaction_id_payment_processor,\n        external_order_id_ecommerce,\n        orders_count,\n        has_uncommitted_changes,\n        cast(retry_date as timestamp) as retry_date,\n        error_type,\n        charge_attempts as times_retried,\n        address_id,\n        client_details_browser_ip,\n        client_details_user_agent,\n        tags,\n        error,\n        external_variant_id_not_found\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.012752Z", "completed_at": "2024-08-06T00:26:17.296688Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.296946Z", "completed_at": "2024-08-06T00:26:17.296952Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3086130619049072, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__checkout", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__checkout_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    token\n    \n as \n    \n    token\n    \n, \n    \n    \n    charge_id\n    \n as \n    \n    charge_id\n    \n, \n    \n    \n    buyer_accepts_marketing\n    \n as \n    \n    buyer_accepts_marketing\n    \n, \n    \n    \n    completed_at\n    \n as \n    \n    completed_at\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    currency\n    \n as \n    \n    currency\n    \n, \n    \n    \n    discount_code\n    \n as \n    \n    discount_code\n    \n, \n    \n    \n    email\n    \n as \n    \n    email\n    \n, \n    \n    \n    external_checkout_id\n    \n as \n    \n    external_checkout_id\n    \n, \n    \n    \n    external_checkout_source\n    \n as \n    \n    external_checkout_source\n    \n, \n    \n    \n    external_transaction_id_payment_processor\n    \n as \n    \n    external_transaction_id_payment_processor\n    \n, \n    \n    \n    order_attributes\n    \n as \n    \n    order_attributes\n    \n, \n    \n    \n    phone\n    \n as \n    \n    phone\n    \n, \n    \n    \n    requires_shipping\n    \n as \n    \n    requires_shipping\n    \n, \n    \n    \n    subtotal_price\n    \n as \n    \n    subtotal_price\n    \n, \n    \n    \n    taxes_included\n    \n as \n    \n    taxes_included\n    \n, \n    \n    \n    total_price\n    \n as \n    \n    total_price\n    \n, \n    \n    \n    total_tax\n    \n as \n    \n    total_tax\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n, \n    cast(null as boolean) as \n    \n    _fivetran_deleted\n    \n \n\n\n    from base\n),\n\nfinal as (\n\n    select\n        token as checkout_id,\n        charge_id,\n        buyer_accepts_marketing,\n        cast(completed_at as timestamp) as checkout_completed_at,\n        cast(created_at as timestamp) as checkout_created_at,\n        currency,\n        discount_code,\n        email,\n        external_checkout_id,\n        external_checkout_source,\n        external_transaction_id_payment_processor,\n        order_attributes,\n        phone,\n        requires_shipping,\n        subtotal_price,\n        taxes_included,\n        total_price,\n        total_tax,\n        cast(updated_at as timestamp) as checkout_updated_at\n\n    \n\n\n\n\n\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__checkout\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:16.975470Z", "completed_at": "2024-08-06T00:26:17.297183Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.297430Z", "completed_at": "2024-08-06T00:26:17.297433Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3475499153137207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__discount", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__discount_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n, \n    \n    \n    starts_at\n    \n as \n    \n    starts_at\n    \n, \n    \n    \n    ends_at\n    \n as \n    \n    ends_at\n    \n, \n    \n    \n    code\n    \n as \n    \n    code\n    \n, \n    \n    \n    value\n    \n as \n    \n    value\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    usage_limits\n    \n as \n    \n    usage_limits\n    \n, \n    \n    \n    applies_to\n    \n as \n    \n    applies_to\n    \n, \n    \n    \n    applies_to_resource\n    \n as \n    \n    applies_to_resource\n    \n, \n    \n    \n    applies_to_id\n    \n as \n    \n    applies_to_id\n    \n, \n    \n    \n    applies_to_product_type\n    \n as \n    \n    applies_to_product_type\n    \n, \n    \n    \n    minimum_order_amount\n    \n as \n    \n    minimum_order_amount\n    \n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        id as discount_id,\n        cast(created_at as timestamp) as discount_created_at,\n        cast(updated_at as timestamp) as discount_updated_at,\n        cast(starts_at as timestamp) as discount_starts_at,\n        cast(ends_at as timestamp) as discount_ends_at,\n        code,\n        value,\n        status,\n        usage_limits,\n        applies_to,\n        applies_to_resource,\n        applies_to_id,\n        applies_to_product_type,\n        minimum_order_amount\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__discount\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.203066Z", "completed_at": "2024-08-06T00:26:17.440293Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.440516Z", "completed_at": "2024-08-06T00:26:17.440522Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2593519687652588, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__customer", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__customer_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    external_customer_id_ecommerce\n    \n as \n    \n    external_customer_id_ecommerce\n    \n, \n    \n    \n    email\n    \n as \n    \n    email\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n, \n    \n    \n    first_charge_processed_at\n    \n as \n    \n    first_charge_processed_at\n    \n, \n    \n    \n    first_name\n    \n as \n    \n    first_name\n    \n, \n    \n    \n    last_name\n    \n as \n    \n    last_name\n    \n, \n    \n    \n    subscriptions_active_count\n    \n as \n    \n    subscriptions_active_count\n    \n, \n    \n    \n    subscriptions_total_count\n    \n as \n    \n    subscriptions_total_count\n    \n, \n    \n    \n    has_valid_payment_method\n    \n as \n    \n    has_valid_payment_method\n    \n, \n    \n    \n    has_payment_method_in_dunning\n    \n as \n    \n    has_payment_method_in_dunning\n    \n, \n    \n    \n    tax_exempt\n    \n as \n    \n    tax_exempt\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    cast(null as TEXT) as \n    \n    billing_first_name\n    \n , \n    cast(null as TEXT) as \n    \n    billing_last_name\n    \n , \n    cast(null as TEXT) as \n    \n    billing_company\n    \n , \n    cast(null as TEXT) as \n    \n    billing_city\n    \n , \n    cast(null as TEXT) as \n    \n    billing_country\n    \n , \n    \n    \n    hash\n    \n as customer_hash \n\n\n    from base\n),\n\nfinal as (\n\n    select\n        id as customer_id,\n        customer_hash,\n        external_customer_id_ecommerce,\n        email,\n        first_name,\n        last_name,\n        cast(created_at as timestamp) as customer_created_at,\n        cast(updated_at as timestamp) as customer_updated_at,\n        cast(first_charge_processed_at as timestamp) as first_charge_processed_at,\n        subscriptions_active_count,\n        subscriptions_total_count,\n        has_valid_payment_method,\n        has_payment_method_in_dunning,\n        tax_exempt,\n        billing_first_name,\n        billing_last_name,\n        billing_company,\n        billing_city,\n        billing_country\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__customer\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.209261Z", "completed_at": "2024-08-06T00:26:17.482997Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.483347Z", "completed_at": "2024-08-06T00:26:17.483353Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2998678684234619, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__order_line_item", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__order_line_item_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    order_id\n    \n as \n    \n    order_id\n    \n, \n    \n    \n    index\n    \n as \n    \n    index\n    \n, \n    \n    \n    variant_title\n    \n as \n    \n    variant_title\n    \n, \n    \n    \n    title\n    \n as \n    \n    title\n    \n, \n    \n    \n    quantity\n    \n as \n    \n    quantity\n    \n, \n    \n    \n    grams\n    \n as \n    \n    grams\n    \n, \n    \n    \n    total_price\n    \n as \n    \n    total_price\n    \n, \n    \n    \n    unit_price\n    \n as \n    \n    unit_price\n    \n, \n    \n    \n    tax_due\n    \n as \n    \n    tax_due\n    \n, \n    \n    \n    taxable\n    \n as \n    \n    taxable\n    \n, \n    \n    \n    taxable_amount\n    \n as \n    \n    taxable_amount\n    \n, \n    \n    \n    unit_price_includes_tax\n    \n as \n    \n    unit_price_includes_tax\n    \n, \n    \n    \n    sku\n    \n as \n    \n    sku\n    \n, \n    \n    \n    external_product_id_ecommerce\n    \n as \n    \n    external_product_id_ecommerce\n    \n, \n    \n    \n    external_variant_id_ecommerce\n    \n as \n    \n    external_variant_id_ecommerce\n    \n, \n    \n    \n    purchase_item_id\n    \n as \n    \n    purchase_item_id\n    \n, \n    \n    \n    purchase_item_type\n    \n as \n    \n    purchase_item_type\n    \n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        order_id,\n        index,\n        external_product_id_ecommerce,\n        external_variant_id_ecommerce,\n        title as order_line_item_title,\n        variant_title as product_variant_title,\n        sku,\n        quantity,\n        grams,\n        cast(total_price as float) as total_price,\n        unit_price,\n        tax_due,\n        taxable,\n        taxable_amount,\n        unit_price_includes_tax,\n        purchase_item_id,\n        purchase_item_type\n\n        \n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__order_line_item\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.328354Z", "completed_at": "2024-08-06T00:26:17.574965Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.575345Z", "completed_at": "2024-08-06T00:26:17.575352Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.27408599853515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__order", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__order_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    customer_id\n    \n as \n    \n    customer_id\n    \n, \n    \n    \n    address_id\n    \n as \n    \n    address_id\n    \n, \n    \n    \n    charge_id\n    \n as \n    \n    charge_id\n    \n, \n    \n    \n    is_deleted\n    \n as \n    \n    is_deleted\n    \n, \n    \n    \n    email\n    \n as \n    \n    email\n    \n, \n    \n    \n    transaction_id\n    \n as \n    \n    transaction_id\n    \n, \n    \n    \n    charge_status\n    \n as \n    \n    charge_status\n    \n, \n    \n    \n    is_prepaid\n    \n as \n    \n    is_prepaid\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    total_price\n    \n as \n    \n    total_price\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    external_order_id_ecommerce\n    \n as \n    \n    external_order_id_ecommerce\n    \n, \n    \n    \n    external_order_number_ecommerce\n    \n as \n    \n    external_order_number_ecommerce\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n, \n    \n    \n    processed_at\n    \n as \n    \n    processed_at\n    \n, \n    \n    \n    scheduled_at\n    \n as \n    \n    scheduled_at\n    \n, \n    \n    \n    shipped_date\n    \n as \n    \n    shipped_date\n    \n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        id as order_id,\n        external_order_id_ecommerce,\n        external_order_number_ecommerce,\n        customer_id,\n        email,\n        cast(created_at as timestamp) as order_created_at,\n        status as order_status,\n        cast(updated_at as timestamp) as order_updated_at,\n        charge_id,\n        transaction_id,\n        charge_status,\n        is_prepaid,\n        cast(total_price as float) as order_total_price,\n        type as order_type,\n        cast(processed_at as timestamp) as order_processed_at,\n        cast(scheduled_at as timestamp) as order_scheduled_at,\n        cast(shipped_date as timestamp) as order_shipped_date,\n        address_id,\n        is_deleted\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__order\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.602962Z", "completed_at": "2024-08-06T00:26:17.611661Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.612194Z", "completed_at": "2024-08-06T00:26:17.612204Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010053157806396484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.dbt_utils_unique_combination_of_columns_stg_recharge__address_discounts_address_id__index.636bfd7451", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        address_id, index\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__address_discounts\"\n    group by address_id, index\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.613752Z", "completed_at": "2024-08-06T00:26:17.619782Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.620127Z", "completed_at": "2024-08-06T00:26:17.620134Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007096052169799805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.not_null_stg_recharge__address_discounts_address_id.7225544f1b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect address_id\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__address_discounts\"\nwhere address_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.323271Z", "completed_at": "2024-08-06T00:26:17.596810Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.597062Z", "completed_at": "2024-08-06T00:26:17.597068Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.30288195610046387, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__one_time_product", "compiled": true, "compiled_code": "\nwith base as (\n\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__one_time_product_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    address_id\n    \n as \n    \n    address_id\n    \n, \n    \n    \n    customer_id\n    \n as \n    \n    customer_id\n    \n, \n    \n    \n    is_deleted\n    \n as \n    \n    is_deleted\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n, \n    \n    \n    next_charge_scheduled_at\n    \n as \n    \n    next_charge_scheduled_at\n    \n, \n    \n    \n    product_title\n    \n as \n    \n    product_title\n    \n, \n    \n    \n    variant_title\n    \n as \n    \n    variant_title\n    \n, \n    \n    \n    price\n    \n as \n    \n    price\n    \n, \n    \n    \n    quantity\n    \n as \n    \n    quantity\n    \n, \n    \n    \n    external_product_id_ecommerce\n    \n as \n    \n    external_product_id_ecommerce\n    \n, \n    \n    \n    external_variant_id_ecommerce\n    \n as \n    \n    external_variant_id_ecommerce\n    \n, \n    \n    \n    sku\n    \n as \n    \n    sku\n    \n, \n    cast(null as boolean) as \n    \n    _fivetran_deleted\n    \n \n\n\n    from base\n),\n\nfinal as (\n    \n    select\n        id as one_time_product_id,\n        address_id,\n        customer_id,\n        is_deleted,\n        cast(created_at as timestamp) as one_time_created_at,\n        cast(updated_at as timestamp) as one_time_updated_at,\n        next_charge_scheduled_at as one_time_next_charge_scheduled_at,\n        product_title,\n        variant_title,\n        price,\n        quantity,\n        external_product_id_ecommerce,\n        external_variant_id_ecommerce,\n        sku\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__one_time_product\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.621705Z", "completed_at": "2024-08-06T00:26:17.625519Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.626098Z", "completed_at": "2024-08-06T00:26:17.626104Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005239009857177734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.dbt_utils_unique_combination_of_columns_stg_recharge__address_shipping_line_address_id__index.ec269cbd74", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        address_id, index\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__address_shipping_line\"\n    group by address_id, index\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.626953Z", "completed_at": "2024-08-06T00:26:17.633150Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.633475Z", "completed_at": "2024-08-06T00:26:17.633483Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00772404670715332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.not_null_stg_recharge__address_shipping_line_address_id.f5fb6034fc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect address_id\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__address_shipping_line\"\nwhere address_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.630211Z", "completed_at": "2024-08-06T00:26:17.634707Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.638822Z", "completed_at": "2024-08-06T00:26:17.638828Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009268999099731445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.not_null_stg_recharge__address_address_id.ffe947d70f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect address_id\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__address\"\nwhere address_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.634905Z", "completed_at": "2024-08-06T00:26:17.644050Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.644366Z", "completed_at": "2024-08-06T00:26:17.644371Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010217905044555664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.unique_stg_recharge__address_address_id.3ea4d98333", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    address_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__address\"\nwhere address_id is not null\ngroup by address_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.640185Z", "completed_at": "2024-08-06T00:26:17.645256Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.645721Z", "completed_at": "2024-08-06T00:26:17.645725Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006133079528808594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.dbt_utils_unique_combination_of_columns_stg_recharge__charge_discount_charge_id__index.87080ff978", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        charge_id, index\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_discount\"\n    group by charge_id, index\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.646196Z", "completed_at": "2024-08-06T00:26:17.649756Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.652781Z", "completed_at": "2024-08-06T00:26:17.652786Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.007827997207641602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.not_null_stg_recharge__charge_discount_charge_id.2efab5c017", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect charge_id\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_discount\"\nwhere charge_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.649981Z", "completed_at": "2024-08-06T00:26:17.656641Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.657165Z", "completed_at": "2024-08-06T00:26:17.657170Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008088827133178711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.dbt_utils_unique_combination_of_columns_stg_recharge__charge_order_attribute_charge_id__index.e3dda1974f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        charge_id, index\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_order_attribute\"\n    group by charge_id, index\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.653971Z", "completed_at": "2024-08-06T00:26:17.658264Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.658752Z", "completed_at": "2024-08-06T00:26:17.658756Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005263805389404297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.not_null_stg_recharge__charge_order_attribute_charge_id.8419846588", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect charge_id\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_order_attribute\"\nwhere charge_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.659546Z", "completed_at": "2024-08-06T00:26:17.665374Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.665612Z", "completed_at": "2024-08-06T00:26:17.665617Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0072100162506103516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.dbt_utils_unique_combination_of_columns_stg_recharge__charge_line_item_charge_id__index.cba28984fe", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        charge_id, index\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_line_item\"\n    group by charge_id, index\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.662817Z", "completed_at": "2024-08-06T00:26:17.666230Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.666712Z", "completed_at": "2024-08-06T00:26:17.666716Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005402088165283203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.not_null_stg_recharge__charge_line_item_charge_id.555f3f4938", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect charge_id\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_line_item\"\nwhere charge_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.668504Z", "completed_at": "2024-08-06T00:26:17.725525Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.725978Z", "completed_at": "2024-08-06T00:26:17.725986Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05961489677429199, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.dbt_utils_unique_combination_of_columns_stg_recharge__charge_shipping_line_charge_id__index.4b9ff30e99", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        charge_id, index\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_shipping_line\"\n    group by charge_id, index\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.722959Z", "completed_at": "2024-08-06T00:26:17.727744Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.730887Z", "completed_at": "2024-08-06T00:26:17.730892Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01937699317932129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.not_null_stg_recharge__charge_shipping_line_charge_id.2e2da51e26", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect charge_id\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_shipping_line\"\nwhere charge_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.727985Z", "completed_at": "2024-08-06T00:26:17.732098Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.735669Z", "completed_at": "2024-08-06T00:26:17.735677Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009080886840820312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.dbt_utils_unique_combination_of_columns_stg_recharge__charge_tax_line_charge_id__index.9fc228fecf", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        charge_id, index\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_tax_line\"\n    group by charge_id, index\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.732302Z", "completed_at": "2024-08-06T00:26:17.742888Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.744392Z", "completed_at": "2024-08-06T00:26:17.744398Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.012864112854003906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.not_null_stg_recharge__charge_tax_line_charge_id.f25f6cb759", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect charge_id\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_tax_line\"\nwhere charge_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.736894Z", "completed_at": "2024-08-06T00:26:17.745541Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.748485Z", "completed_at": "2024-08-06T00:26:17.748494Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.012089014053344727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge.recharge__charge_line_item_history", "compiled": true, "compiled_code": "with charges as (\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge\"\n\n), charge_line_items as (\n    select \n        charge_id,\n        index,\n        cast(total_price as float) as amount,\n        title,\n        'charge line' as line_item_type\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_line_item\"\n\n), charge_discounts as (\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_discount\"\n\n), discounts_enriched as (\n    select\n        charge_discounts.charge_id,\n        charge_discounts.index,\n        cast(case when lower(charge_discounts.value_type) = 'percentage'\n            then round(cast(charge_discounts.discount_value / 100 * charges.total_line_items_price as numeric(28,6)), 2)\n            else charge_discounts.discount_value \n            end as float) as amount,\n        charge_discounts.code as title,\n        'discount' as line_item_type\n    from charge_discounts\n    left join charges\n        on charges.charge_id = charge_discounts.charge_id\n\n), charge_shipping_lines as (\n    select \n        charge_id,\n        index,\n        cast(price as float) as amount,\n        title,\n        'shipping' as line_item_type\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_shipping_line\"\n\n), charge_tax_lines as (\n    \n        select \n            charge_id,\n            index,\n            cast(price as float) as amount,\n            title,\n            'tax' as line_item_type\n        from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_tax_line\" -- use this if possible since it is individual tax items\n    \n\n), refunds as (\n    select\n        charge_id,\n        0 as index,\n        cast(total_refunds as float) as amount,\n        'total refunds' as title,\n        'refund' as line_item_type\n    from charges -- have to extract refunds from charges table since a refund line item table is not available\n    where total_refunds > 0\n\n), unioned as (\n\n    select *\n    from charge_line_items\n\n    union all\n    select *\n    from discounts_enriched\n\n    union all\n    select *\n    from charge_shipping_lines\n\n    union all\n    select *\n    from charge_tax_lines\n    \n    union all\n    select *\n    from refunds\n\n), joined as (\n    select\n        unioned.charge_id,\n        row_number() over(partition by unioned.charge_id \n            order by unioned.line_item_type, unioned.index) \n            as charge_row_num,\n        unioned.index as source_index,\n        charges.charge_created_at,\n        charges.customer_id,\n        charges.address_id,\n        unioned.amount,\n        unioned.title,\n        unioned.line_item_type\n    from unioned\n    left join charges\n        on charges.charge_id = unioned.charge_id\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__charge_line_item_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.745776Z", "completed_at": "2024-08-06T00:26:17.749674Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.752527Z", "completed_at": "2024-08-06T00:26:17.752534Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.007472038269042969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.not_null_stg_recharge__charge_charge_id.e40d1f4998", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect charge_id\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge\"\nwhere charge_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.749888Z", "completed_at": "2024-08-06T00:26:17.753780Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.756873Z", "completed_at": "2024-08-06T00:26:17.756881Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007703065872192383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.unique_stg_recharge__charge_charge_id.a013ccef10", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    charge_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge\"\nwhere charge_id is not null\ngroup by charge_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.462881Z", "completed_at": "2024-08-06T00:26:17.726939Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.727521Z", "completed_at": "2024-08-06T00:26:17.727527Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2955820560455322, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__subscription_history", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__subscription_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    subscription_id\n    \n as \n    \n    subscription_id\n    \n, \n    cast(null as integer) as \n    \n    id\n    \n , \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n, \n    \n    \n    address_id\n    \n as \n    \n    address_id\n    \n, \n    \n    \n    customer_id\n    \n as \n    \n    customer_id\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    cancelled_at\n    \n as \n    \n    cancelled_at\n    \n, \n    \n    \n    next_charge_scheduled_at\n    \n as \n    \n    next_charge_scheduled_at\n    \n, \n    \n    \n    price\n    \n as \n    \n    price\n    \n, \n    \n    \n    quantity\n    \n as \n    \n    quantity\n    \n, \n    \n    \n    cancellation_reason\n    \n as \n    \n    cancellation_reason\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    cancellation_reason_comments\n    \n as \n    \n    cancellation_reason_comments\n    \n, \n    \n    \n    product_title\n    \n as \n    \n    product_title\n    \n, \n    \n    \n    variant_title\n    \n as \n    \n    variant_title\n    \n, \n    \n    \n    external_product_id_ecommerce\n    \n as \n    \n    external_product_id_ecommerce\n    \n, \n    \n    \n    external_variant_id_ecommerce\n    \n as \n    \n    external_variant_id_ecommerce\n    \n, \n    \n    \n    sku\n    \n as \n    \n    sku\n    \n, \n    \n    \n    order_interval_unit\n    \n as \n    \n    order_interval_unit\n    \n, \n    \n    \n    order_interval_frequency\n    \n as \n    \n    order_interval_frequency\n    \n, \n    \n    \n    charge_interval_frequency\n    \n as \n    \n    charge_interval_frequency\n    \n, \n    \n    \n    order_day_of_week\n    \n as \n    \n    order_day_of_week\n    \n, \n    \n    \n    order_day_of_month\n    \n as \n    \n    order_day_of_month\n    \n, \n    \n    \n    expire_after_specific_number_of_charges\n    \n as \n    \n    expire_after_specific_number_of_charges\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        coalesce(cast(id as integer), cast(subscription_id as integer)) as subscription_id,\n        customer_id,\n        address_id,\n        cast(created_at as timestamp) as subscription_created_at,\n        external_product_id_ecommerce,\n        external_variant_id_ecommerce,\n        product_title,\n        variant_title,\n        sku,\n        cast(price as float) as price,\n        quantity,\n        status as subscription_status,\n        charge_interval_frequency,\n        order_interval_unit,\n        order_interval_frequency,\n        order_day_of_month,\n        order_day_of_week,\n        expire_after_specific_number_of_charges,\n        cast(updated_at as timestamp) as subscription_updated_at,\n        cast(next_charge_scheduled_at as timestamp) as subscription_next_charge_scheduled_at,\n        cast(cancelled_at as timestamp) as subscription_cancelled_at,\n        cancellation_reason,\n        cancellation_reason_comments,\n        _fivetran_synced,\n        row_number() over (partition by subscription_id order by updated_at desc) = 1 as is_most_recent_record\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__subscription_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.753978Z", "completed_at": "2024-08-06T00:26:17.758943Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.760049Z", "completed_at": "2024-08-06T00:26:17.760058Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006822347640991211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.not_null_stg_recharge__checkout_checkout_id.fb781847d8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect checkout_id\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__checkout\"\nwhere checkout_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.760555Z", "completed_at": "2024-08-06T00:26:17.769002Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.769768Z", "completed_at": "2024-08-06T00:26:17.769777Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01158595085144043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.unique_stg_recharge__checkout_checkout_id.8ab72bed8a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    checkout_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__checkout\"\nwhere checkout_id is not null\ngroup by checkout_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.765704Z", "completed_at": "2024-08-06T00:26:17.772946Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.773635Z", "completed_at": "2024-08-06T00:26:17.773640Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01396036148071289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.not_null_stg_recharge__discount_discount_id.71ea1251b3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect discount_id\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__discount\"\nwhere discount_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.770198Z", "completed_at": "2024-08-06T00:26:17.774800Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.778023Z", "completed_at": "2024-08-06T00:26:17.778029Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009390830993652344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.unique_stg_recharge__discount_discount_id.5e928f569c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    discount_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__discount\"\nwhere discount_id is not null\ngroup by discount_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.775297Z", "completed_at": "2024-08-06T00:26:17.781618Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.782349Z", "completed_at": "2024-08-06T00:26:17.782357Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008391857147216797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.not_null_stg_recharge__customer_customer_id.0f267f14ba", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__customer\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.778901Z", "completed_at": "2024-08-06T00:26:17.783366Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.788317Z", "completed_at": "2024-08-06T00:26:17.788324Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013347864151000977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.unique_stg_recharge__customer_customer_id.1dcf3f6410", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__customer\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.783684Z", "completed_at": "2024-08-06T00:26:17.791900Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.792440Z", "completed_at": "2024-08-06T00:26:17.792445Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010578155517578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.dbt_utils_unique_combination_of_columns_stg_recharge__order_line_item_order_id__index.e56621b39a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        order_id, index\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__order_line_item\"\n    group by order_id, index\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.789283Z", "completed_at": "2024-08-06T00:26:17.793244Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.801035Z", "completed_at": "2024-08-06T00:26:17.801043Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013099193572998047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.not_null_stg_recharge__order_line_item_order_id.bf548aca5f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__order_line_item\"\nwhere order_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.793444Z", "completed_at": "2024-08-06T00:26:17.804784Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.805348Z", "completed_at": "2024-08-06T00:26:17.805355Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013319969177246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge.recharge__billing_history", "compiled": true, "compiled_code": "with orders as (\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__order\"\n\n), order_line_items as (\n    select \n        order_id,\n        sum(quantity) as order_item_quantity,\n        round(cast(sum(total_price) as numeric(28,6)), 2) as order_line_item_total\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__order_line_item\"\n    group by 1\n\n\n), charges as ( --each charge can have multiple orders associated with it\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge\"\n\n), charge_shipping_lines as (\n    select \n        charge_id,\n        round(cast(sum(price) as numeric(28,6)), 2) as total_shipping\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_shipping_line\"\n    group by 1\n\n), charges_enriched as (\n    select\n        charges.*,\n        charge_shipping_lines.total_shipping\n    from charges\n    left join charge_shipping_lines\n        on charge_shipping_lines.charge_id = charges.charge_id\n\n), joined as (\n    select \n        orders.*,\n        -- recognized_total (calculated total based on prepaid subscriptions)\n        charges_enriched.charge_created_at,\n        charges_enriched.payment_processor,\n        charges_enriched.tags,\n        charges_enriched.orders_count,\n        charges_enriched.charge_type,\n        \n        \n            -- when several prepaid orders are generated from a single charge, we only want to show total aggregates from the charge on the first instance.\n            case when orders.is_prepaid = true then 0 \n                else coalesce(charges_enriched.total_price, 0)\n                end as charge_total_price,\n            -- this divides a charge over all the related orders.\n            coalesce(round(cast(\n    ( charges_enriched.total_price ) / nullif( ( charges_enriched.orders_count ), 0)\n as numeric(28,6)), 2), 0)\n                as calculated_order_total_price,\n        \n            -- when several prepaid orders are generated from a single charge, we only want to show total aggregates from the charge on the first instance.\n            case when orders.is_prepaid = true then 0 \n                else coalesce(charges_enriched.subtotal_price, 0)\n                end as charge_subtotal_price,\n            -- this divides a charge over all the related orders.\n            coalesce(round(cast(\n    ( charges_enriched.subtotal_price ) / nullif( ( charges_enriched.orders_count ), 0)\n as numeric(28,6)), 2), 0)\n                as calculated_order_subtotal_price,\n        \n            -- when several prepaid orders are generated from a single charge, we only want to show total aggregates from the charge on the first instance.\n            case when orders.is_prepaid = true then 0 \n                else coalesce(charges_enriched.tax_lines, 0)\n                end as charge_tax_lines,\n            -- this divides a charge over all the related orders.\n            coalesce(round(cast(\n    ( charges_enriched.tax_lines ) / nullif( ( charges_enriched.orders_count ), 0)\n as numeric(28,6)), 2), 0)\n                as calculated_order_tax_lines,\n        \n            -- when several prepaid orders are generated from a single charge, we only want to show total aggregates from the charge on the first instance.\n            case when orders.is_prepaid = true then 0 \n                else coalesce(charges_enriched.total_discounts, 0)\n                end as charge_total_discounts,\n            -- this divides a charge over all the related orders.\n            coalesce(round(cast(\n    ( charges_enriched.total_discounts ) / nullif( ( charges_enriched.orders_count ), 0)\n as numeric(28,6)), 2), 0)\n                as calculated_order_total_discounts,\n        \n            -- when several prepaid orders are generated from a single charge, we only want to show total aggregates from the charge on the first instance.\n            case when orders.is_prepaid = true then 0 \n                else coalesce(charges_enriched.total_refunds, 0)\n                end as charge_total_refunds,\n            -- this divides a charge over all the related orders.\n            coalesce(round(cast(\n    ( charges_enriched.total_refunds ) / nullif( ( charges_enriched.orders_count ), 0)\n as numeric(28,6)), 2), 0)\n                as calculated_order_total_refunds,\n        \n            -- when several prepaid orders are generated from a single charge, we only want to show total aggregates from the charge on the first instance.\n            case when orders.is_prepaid = true then 0 \n                else coalesce(charges_enriched.total_tax, 0)\n                end as charge_total_tax,\n            -- this divides a charge over all the related orders.\n            coalesce(round(cast(\n    ( charges_enriched.total_tax ) / nullif( ( charges_enriched.orders_count ), 0)\n as numeric(28,6)), 2), 0)\n                as calculated_order_total_tax,\n        \n            -- when several prepaid orders are generated from a single charge, we only want to show total aggregates from the charge on the first instance.\n            case when orders.is_prepaid = true then 0 \n                else coalesce(charges_enriched.total_weight_grams, 0)\n                end as charge_total_weight_grams,\n            -- this divides a charge over all the related orders.\n            coalesce(round(cast(\n    ( charges_enriched.total_weight_grams ) / nullif( ( charges_enriched.orders_count ), 0)\n as numeric(28,6)), 2), 0)\n                as calculated_order_total_weight_grams,\n        \n            -- when several prepaid orders are generated from a single charge, we only want to show total aggregates from the charge on the first instance.\n            case when orders.is_prepaid = true then 0 \n                else coalesce(charges_enriched.total_shipping, 0)\n                end as charge_total_shipping,\n            -- this divides a charge over all the related orders.\n            coalesce(round(cast(\n    ( charges_enriched.total_shipping ) / nullif( ( charges_enriched.orders_count ), 0)\n as numeric(28,6)), 2), 0)\n                as calculated_order_total_shipping,\n        \n        coalesce(order_line_items.order_item_quantity, 0) as order_item_quantity,\n        coalesce(order_line_items.order_line_item_total, 0) as order_line_item_total\n    from orders\n    left join order_line_items\n        on order_line_items.order_id = orders.order_id\n    left join charges_enriched -- still want to capture charges that don't have an order yet\n        on charges_enriched.charge_id = orders.charge_id\n\n), joined_enriched as (\n    select \n        joined.*,\n        -- total_price includes taxes and discounts, so only need to subtract total_refunds to get net.\n        charge_total_price - charge_total_refunds as total_net_charge_value,\n        calculated_order_total_price - calculated_order_total_refunds as total_calculated_net_order_value  \n    from joined\n)\n\nselect * \nfrom joined_enriched", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__billing_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.802026Z", "completed_at": "2024-08-06T00:26:17.809337Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.810141Z", "completed_at": "2024-08-06T00:26:17.810148Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009473085403442383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.not_null_stg_recharge__order_order_id.70fc03aaa7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__order\"\nwhere order_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.806514Z", "completed_at": "2024-08-06T00:26:17.821427Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.822297Z", "completed_at": "2024-08-06T00:26:17.822303Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01738286018371582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.unique_stg_recharge__order_order_id.bab2588ddd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__order\"\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.822780Z", "completed_at": "2024-08-06T00:26:17.830019Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.830689Z", "completed_at": "2024-08-06T00:26:17.830695Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.020977258682250977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.not_null_stg_recharge__one_time_product_one_time_product_id.03a2a12d7d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect one_time_product_id\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__one_time_product\"\nwhere one_time_product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.827372Z", "completed_at": "2024-08-06T00:26:17.834291Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.834886Z", "completed_at": "2024-08-06T00:26:17.834892Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009214162826538086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.unique_stg_recharge__one_time_product_one_time_product_id.8ccb87ed5b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    one_time_product_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__one_time_product\"\nwhere one_time_product_id is not null\ngroup by one_time_product_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.831115Z", "completed_at": "2024-08-06T00:26:17.835787Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.839720Z", "completed_at": "2024-08-06T00:26:17.839726Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.012649059295654297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge.dbt_utils_unique_combination_of_columns_recharge__charge_line_item_history_charge_id__charge_row_num.1863e6df2f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        charge_id, charge_row_num\n    from \"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__charge_line_item_history\"\n    group by charge_id, charge_row_num\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.836002Z", "completed_at": "2024-08-06T00:26:17.855817Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.856595Z", "completed_at": "2024-08-06T00:26:17.856601Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.022082090377807617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge.not_null_recharge__charge_line_item_history_charge_id.48a34a867c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect charge_id\nfrom \"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__charge_line_item_history\"\nwhere charge_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.509982Z", "completed_at": "2024-08-06T00:26:17.826029Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.826888Z", "completed_at": "2024-08-06T00:26:17.826893Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3479177951812744, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge_source.stg_recharge__subscription", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__subscription_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    address_id\n    \n as \n    \n    address_id\n    \n, \n    \n    \n    customer_id\n    \n as \n    \n    customer_id\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    cancelled_at\n    \n as \n    \n    cancelled_at\n    \n, \n    \n    \n    next_charge_scheduled_at\n    \n as \n    \n    next_charge_scheduled_at\n    \n, \n    \n    \n    price\n    \n as \n    \n    price\n    \n, \n    \n    \n    quantity\n    \n as \n    \n    quantity\n    \n, \n    \n    \n    cancellation_reason\n    \n as \n    \n    cancellation_reason\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    cancellation_reason_comments\n    \n as \n    \n    cancellation_reason_comments\n    \n, \n    \n    \n    product_title\n    \n as \n    \n    product_title\n    \n, \n    \n    \n    variant_title\n    \n as \n    \n    variant_title\n    \n, \n    \n    \n    external_product_id_ecommerce\n    \n as \n    \n    external_product_id_ecommerce\n    \n, \n    \n    \n    external_variant_id_ecommerce\n    \n as \n    \n    external_variant_id_ecommerce\n    \n, \n    \n    \n    sku\n    \n as \n    \n    sku\n    \n, \n    \n    \n    order_interval_unit\n    \n as \n    \n    order_interval_unit\n    \n, \n    \n    \n    order_interval_frequency\n    \n as \n    \n    order_interval_frequency\n    \n, \n    \n    \n    charge_interval_frequency\n    \n as \n    \n    charge_interval_frequency\n    \n, \n    \n    \n    order_day_of_week\n    \n as \n    \n    order_day_of_week\n    \n, \n    \n    \n    order_day_of_month\n    \n as \n    \n    order_day_of_month\n    \n, \n    \n    \n    expire_after_specific_number_of_charges\n    \n as \n    \n    expire_after_specific_number_of_charges\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        id as subscription_id,\n        customer_id,\n        address_id,\n        cast(created_at as timestamp) as subscription_created_at,\n        product_title,\n        variant_title,\n        sku,\n        cast(price as float) as price,\n        quantity,\n        status as subscription_status,\n        next_charge_scheduled_at as subscription_next_charge_scheduled_at,\n        charge_interval_frequency,\n        expire_after_specific_number_of_charges,\n        order_interval_frequency,\n        order_interval_unit,\n        order_day_of_week,\n        order_day_of_month,\n        cast(updated_at as timestamp) as subscription_updated_at,\n        external_product_id_ecommerce,\n        external_variant_id_ecommerce,\n        cast(cancelled_at as timestamp) as subscription_cancelled_at,\n        cancellation_reason,\n        cancellation_reason_comments\n\n        \n\n\n\n\n\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__subscription\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.840670Z", "completed_at": "2024-08-06T00:26:17.857848Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.861700Z", "completed_at": "2024-08-06T00:26:17.861705Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02230095863342285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge.recharge__line_item_enhanced", "compiled": true, "compiled_code": "with charge_line_items as (\n\n    select * \n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_line_item\"\n\n), charges as (\n\n    select * \n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge\"\n\n), charge_shipping_lines as (\n\n    select\n        charge_id,\n        sum(price) as total_shipping\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_shipping_line\"\n    group by 1\n\n\n), checkouts as (\n\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__checkout\"\n\n\n\n), addresses as (\n\n    select * \n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__address\"\n\n), customers as (\n\n    select * \n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__customer\"\n\n), subscriptions as (\n\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__subscription_history\" \n    where is_most_recent_record\n\n), enhanced as (\n    select\n        cast(charge_line_items.charge_id as TEXT) as header_id,\n        cast(charge_line_items.index as TEXT) as line_item_id,\n        row_number() over (partition by charge_line_items.charge_id\n            order by charge_line_items.index) as line_item_index,\n\n        -- header level fields\n        charges.charge_created_at as created_at,\n        charges.charge_status as header_status,\n        cast(charges.total_discounts as numeric(28,6)) as discount_amount,\n        cast(charges.total_refunds as numeric(28,6)) as refund_amount,\n        cast(charge_shipping_lines.total_shipping as numeric(28,6)) as fee_amount,\n        addresses.payment_method_id,\n        charges.external_transaction_id_payment_processor as payment_id,\n        charges.payment_processor as payment_method,\n        charges.charge_processed_at as payment_at,\n        charges.charge_type as billing_type,  -- possible values: checkout, recurring\n\n        -- Currency is in the Charges api object but not the Fivetran schema, so relying on Checkouts for now.\n        -- Checkouts has only 20% utilization, so we should switch to the Charges field when it is added.\n        cast(null as TEXT) as currency,\n\n        -- line item level fields\n        cast(charge_line_items.purchase_item_type as TEXT) as transaction_type, -- possible values: subscription, onetime\n        cast(charge_line_items.external_product_id_ecommerce as TEXT) as product_id,\n        cast(charge_line_items.title as TEXT) as product_name,\n        cast(null as TEXT) as product_type, -- product_type not available\n        cast(charge_line_items.quantity as integer) as quantity,\n        cast(charge_line_items.unit_price as numeric(28,6)) as unit_amount,\n        cast(charge_line_items.tax_due as numeric(28,6)) as tax_amount,\n        cast(charge_line_items.total_price as numeric(28,6)) as total_amount,\n        case when charge_line_items.purchase_item_type = 'subscription'\n            then cast(charge_line_items.purchase_item_id as TEXT)\n            end as subscription_id,\n        subscriptions.product_title as subscription_plan,\n        subscriptions.subscription_created_at as subscription_period_started_at,\n        subscriptions.subscription_cancelled_at as subscription_period_ended_at,\n        cast(subscriptions.subscription_status as TEXT) as subscription_status,\n        'customer' as customer_level,\n        cast(charges.customer_id as TEXT) as customer_id,\n        cast(customers.customer_created_at as timestamp) as customer_created_at,\n        -- coalesces are since information may be incomplete in various tables and casts for consistency\n        coalesce(\n            cast(charges.email as TEXT),\n            cast(customers.email as TEXT)\n            ) as customer_email,\n        coalesce(\n            customers.billing_first_name || ' ' || customers.billing_last_name,\n            addresses.first_name || ' ' || addresses.last_name\n            ) as customer_name,\n        coalesce(cast(customers.billing_company as TEXT),\n            cast(addresses.company as TEXT)\n            ) as customer_company,\n        coalesce(cast(customers.billing_city as TEXT),\n            cast(addresses.city as TEXT)\n            ) as customer_city,\n        coalesce(cast(customers.billing_country as TEXT),\n            cast(addresses.country as TEXT)\n            ) as customer_country\n\n    from charge_line_items\n\n    left join charges\n        on charges.charge_id = charge_line_items.charge_id\n\n    left join addresses\n        on addresses.address_id = charges.address_id\n\n    left join customers\n        on customers.customer_id = charges.customer_id\n\n    \n    left join checkouts\n        on checkouts.charge_id = charges.charge_id\n    \n\n    left join charge_shipping_lines\n        on charge_shipping_lines.charge_id = charges.charge_id\n\n    left join subscriptions\n        on subscriptions.subscription_id = charge_line_items.purchase_item_id\n\n), final as (\n\n    -- line item level\n    select \n        header_id,\n        line_item_id,\n        line_item_index,\n        'line_item' as record_type,\n        created_at,\n        currency,\n        header_status,\n        product_id,\n        product_name,\n        transaction_type,\n        billing_type,\n        product_type,\n        quantity,\n        unit_amount,\n        cast(null as numeric(28,6)) as discount_amount,\n        tax_amount,\n        total_amount,\n        payment_id,\n        payment_method_id,\n        payment_method,\n        payment_at,\n        cast(null as numeric(28,6)) as fee_amount,\n        cast(null as numeric(28,6)) as refund_amount,\n        subscription_id,\n        subscription_plan,\n        subscription_period_started_at,\n        subscription_period_ended_at,\n        subscription_status,\n        customer_id,\n        customer_created_at,\n        customer_level,\n        customer_name,\n        customer_company,\n        customer_email,\n        customer_city,\n        customer_country\n    from enhanced\n\n    union all\n\n    -- header level\n    select\n        header_id,\n        cast(null as TEXT) as line_item_id,\n        cast(0 as integer) as line_item_index,\n        'header' as record_type,\n        created_at,\n        currency,\n        header_status,\n        cast(null as TEXT) as product_id,\n        cast(null as TEXT) as product_name,\n        cast(null as TEXT) as transaction_type,\n        billing_type,\n        cast(null as TEXT) as product_type,\n        cast(null as integer) as quantity,\n        cast(null as numeric(28,6)) as unit_amount,\n        discount_amount,\n        cast(null as numeric(28,6)) as tax_amount,\n        cast(null as numeric(28,6)) as total_amount,\n        payment_id,\n        payment_method_id,\n        payment_method,\n        payment_at,\n        fee_amount,\n        refund_amount,\n        cast(null as TEXT) as subscription_id,\n        cast(null as TEXT) as subscription_plan,\n        cast(null as timestamp) as subscription_period_started_at,\n        cast(null as timestamp) as subscription_period_ended_at,\n        cast(null as TEXT) as subscription_status,\n        customer_id,\n        customer_created_at,\n        customer_level,\n        customer_name,\n        customer_company,\n        customer_email,\n        customer_city,\n        customer_country\n    from enhanced\n    where line_item_index = 1\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__line_item_enhanced\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.858051Z", "completed_at": "2024-08-06T00:26:17.863086Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.870186Z", "completed_at": "2024-08-06T00:26:17.870192Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01398921012878418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge.recharge__subscription_overview", "compiled": true, "compiled_code": "with subscriptions as (\n\n    select * \n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__subscription_history\"\n    where is_most_recent_record\n\n), charges as (\n    select * \n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge\"\n    where lower(charge_type) = 'recurring'\n\n), charge_line_items as (\n    select * \n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__charge_line_item\"\n\n), customers_charge_lines as (\n    select \n        charge_line_items.charge_id,\n        charge_line_items.purchase_item_id,\n        charge_line_items.external_product_id_ecommerce,\n        charge_line_items.external_variant_id_ecommerce,\n        charges.customer_id,\n        charges.address_id,\n        charges.charge_created_at,\n        charges.charge_status\n    from charge_line_items\n    left join charges\n        on charges.charge_id = charge_line_items.charge_id\n\n), subscriptions_charges as (\n    select \n        subscriptions.subscription_id,\n        count(case when lower(customers_charge_lines.charge_status) = 'success' \n            then 1 else null\n            end) as count_successful_charges,\n        count(case when lower(customers_charge_lines.charge_status) = 'queued' \n            then 1 else null\n            end) as count_queued_charges\n    from subscriptions\n    left join customers_charge_lines\n        on customers_charge_lines.purchase_item_id = subscriptions.subscription_id\n    group by 1\n\n), subscriptions_enriched as (\n    select\n        subscriptions.*,\n        subscriptions_charges.count_successful_charges,\n        subscriptions_charges.count_queued_charges,\n        case when subscription_next_charge_scheduled_at is null then null\n            when expire_after_specific_number_of_charges - count_successful_charges < 0 then null\n            else expire_after_specific_number_of_charges - count_successful_charges\n            end as charges_until_expiration,\n        case when lower(order_interval_unit) = 'month' then charge_interval_frequency * 30\n            when lower(order_interval_unit) = 'week' then charge_interval_frequency * 7\n            else charge_interval_frequency \n            end as charge_interval_frequency_days\n    from subscriptions\n    left join subscriptions_charges\n        on subscriptions_charges.subscription_id = subscriptions.subscription_id\n)\n\nselect * \nfrom subscriptions_enriched", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__subscription_overview\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.863296Z", "completed_at": "2024-08-06T00:26:17.871494Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.875010Z", "completed_at": "2024-08-06T00:26:17.875015Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013626813888549805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.dbt_utils_unique_combination_of_columns_stg_recharge__subscription_history_subscription_id__subscription_updated_at.7eefd56269", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        subscription_id, subscription_updated_at\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__subscription_history\"\n    group by subscription_id, subscription_updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.866872Z", "completed_at": "2024-08-06T00:26:17.874472Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.875423Z", "completed_at": "2024-08-06T00:26:17.875427Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013360977172851562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.not_null_stg_recharge__subscription_history_subscription_id.678aed985c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__subscription_history\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.871751Z", "completed_at": "2024-08-06T00:26:17.876505Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.879764Z", "completed_at": "2024-08-06T00:26:17.879768Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.013189077377319336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge.not_null_recharge__billing_history_order_id.d9c88b8dff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom \"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__billing_history\"\nwhere order_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.876746Z", "completed_at": "2024-08-06T00:26:17.880790Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.886611Z", "completed_at": "2024-08-06T00:26:17.886621Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011986017227172852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge.unique_recharge__billing_history_order_id.05decc3c47", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__billing_history\"\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.880995Z", "completed_at": "2024-08-06T00:26:17.893278Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.895406Z", "completed_at": "2024-08-06T00:26:17.895411Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01617288589477539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.not_null_stg_recharge__subscription_subscription_id.c2f0892c32", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__subscription\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.883673Z", "completed_at": "2024-08-06T00:26:17.894847Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.895847Z", "completed_at": "2024-08-06T00:26:17.895851Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016356706619262695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge_source.unique_stg_recharge__subscription_subscription_id.bed39b80ea", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__subscription\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.897310Z", "completed_at": "2024-08-06T00:26:17.904568Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.907433Z", "completed_at": "2024-08-06T00:26:17.907439Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.012377738952636719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge.dbt_utils_unique_combination_of_columns_recharge__line_item_enhanced_header_id__line_item_index.8e3f9f7be6", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        header_id, line_item_index\n    from \"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__line_item_enhanced\"\n    group by header_id, line_item_index\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.902141Z", "completed_at": "2024-08-06T00:26:17.925478Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.928470Z", "completed_at": "2024-08-06T00:26:17.928478Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0279541015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge.not_null_recharge__subscription_overview_subscription_id.edad857cc3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__subscription_overview\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.904993Z", "completed_at": "2024-08-06T00:26:17.929048Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.929378Z", "completed_at": "2024-08-06T00:26:17.929387Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02826714515686035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge.unique_recharge__subscription_overview_subscription_id.ead71825cd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__subscription_overview\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.907847Z", "completed_at": "2024-08-06T00:26:17.930222Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.930462Z", "completed_at": "2024-08-06T00:26:17.930466Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02883601188659668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge.recharge__customer_details", "compiled": true, "compiled_code": "with  __dbt__cte__int_recharge__customer_details as (\nwith customers as (\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__customer\"\n\n), billing as (\n    select * \n    from \"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__billing_history\"\n\n-- Agg'd on customer_id\n), order_aggs as ( \n    select \n        customer_id,\n        count(order_id) as total_orders,\n        round(cast(sum(order_total_price) as numeric(28,6)), 2) as total_amount_ordered,\n        round(cast(avg(order_total_price) as numeric(28,6)), 2) as avg_order_amount,\n        round(cast(sum(order_item_quantity) as numeric(28,6)), 2) as total_quantity_ordered,\n        round(cast(avg(order_item_quantity) as numeric(28,6)), 2) as avg_item_quantity_per_order,\n        round(cast(sum(order_line_item_total) as numeric(28,6)), 2) as total_order_line_item_total,\n        round(cast(avg(order_line_item_total) as numeric(28,6)), 2) as avg_order_line_item_total\n    from billing\n    where lower(order_status) not in ('error', 'cancelled', 'queued') --possible values: success, error, queued, skipped, refunded or partially_refunded\n    group by 1\n\n), charge_aggs as (\n    select \n        customer_id,\n        count(distinct charge_id) as charges_count,\n        round(cast(sum(charge_total_price) as numeric(28,6)), 2) as total_amount_charged,\n        round(cast(avg(charge_total_price) as numeric(28,6)), 2) as avg_amount_charged,\n        round(cast(sum(charge_total_tax) as numeric(28,6)), 2) as total_amount_taxed,\n        round(cast(sum(charge_total_discounts) as numeric(28,6)), 2) as total_amount_discounted,\n        round(cast(sum(charge_total_refunds) as numeric(28,6)), 2) as total_refunds,\n        count(case when lower(billing.charge_type) = 'checkout' then 1 else null end) as total_one_time_purchases\n    from billing\n    where lower(charge_status) not in ('error', 'skipped', 'queued')\n    group by 1\n\n), subscriptions as (\n    select \n        customer_id,\n        count(subscription_id) as calculated_subscriptions_active_count -- this value may differ from the recharge-provided subscriptions_active_count. See DECISIONLOG. \n    from \"postgres\".\"recharge_integration_tests_03_recharge_source\".\"stg_recharge__subscription\"\n    where lower(subscription_status) = 'active'\n    group by 1\n\n), joined as (\n    select \n        customers.*,\n        order_aggs.total_orders,\n        order_aggs.total_amount_ordered,\n        order_aggs.avg_order_amount,\n        order_aggs.total_order_line_item_total,\n        order_aggs.avg_order_line_item_total,\n        order_aggs.avg_item_quantity_per_order, --units_per_transaction\n        charge_aggs.total_amount_charged,\n        charge_aggs.avg_amount_charged,\n        charge_aggs.charges_count,\n        charge_aggs.total_amount_taxed,\n        charge_aggs.total_amount_discounted,\n        charge_aggs.total_refunds,\n        charge_aggs.total_one_time_purchases,\n        round(cast(charge_aggs.avg_amount_charged - charge_aggs.total_refunds as numeric(28,6)), 2) \n            as total_net_spend,\n        coalesce(subscriptions.calculated_subscriptions_active_count, 0) as calculated_subscriptions_active_count\n    from customers\n    left join charge_aggs \n        on charge_aggs.customer_id = customers.customer_id\n    left join order_aggs\n        on order_aggs.customer_id = customers.customer_id\n    left join subscriptions\n        on subscriptions.customer_id = customers.customer_id\n\n)\n\nselect * \nfrom joined\n), customers as (\n    select *\n    from __dbt__cte__int_recharge__customer_details \n\n), enriched as (\n    select \n        customers.*,\n        case when subscriptions_active_count > 0 \n            then true else false end as is_currently_subscribed,\n        case when \n        ((\n    current_timestamp::timestamp\n)::date - (first_charge_processed_at)::date)\n     <= 30\n            then true else false end as is_new_customer,\n        round(cast(\n        ((\n    current_timestamp::timestamp\n)::date - (first_charge_processed_at)::date)\n     / 30 as numeric(28,6)), 2)\n            as active_months\n    from customers\n\n), aggs as (\n    select\n        enriched.*,\n        \n        \n            round(cast(\n    ( total_orders ) / nullif( ( active_months ), 0)\n as numeric(28,6)), 2) \n                as orders_monthly_average -- calculates average over no. active mos\n            ,\n            round(cast(\n    ( total_amount_ordered ) / nullif( ( active_months ), 0)\n as numeric(28,6)), 2) \n                as amount_ordered_monthly_average -- calculates average over no. active mos\n            ,\n            round(cast(\n    ( total_one_time_purchases ) / nullif( ( active_months ), 0)\n as numeric(28,6)), 2) \n                as one_time_purchases_monthly_average -- calculates average over no. active mos\n            ,\n            round(cast(\n    ( total_amount_charged ) / nullif( ( active_months ), 0)\n as numeric(28,6)), 2) \n                as amount_charged_monthly_average -- calculates average over no. active mos\n            ,\n            round(cast(\n    ( total_amount_discounted ) / nullif( ( active_months ), 0)\n as numeric(28,6)), 2) \n                as amount_discounted_monthly_average -- calculates average over no. active mos\n            ,\n            round(cast(\n    ( total_amount_taxed ) / nullif( ( active_months ), 0)\n as numeric(28,6)), 2) \n                as amount_taxed_monthly_average -- calculates average over no. active mos\n            ,\n            round(cast(\n    ( total_net_spend ) / nullif( ( active_months ), 0)\n as numeric(28,6)), 2) \n                as net_spend_monthly_average -- calculates average over no. active mos\n            \n    from enriched\n)\n\nselect * \nfrom aggs", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__customer_details\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.932591Z", "completed_at": "2024-08-06T00:26:17.946219Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.946698Z", "completed_at": "2024-08-06T00:26:17.946706Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.015585184097290039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.recharge.recharge__churn_analysis", "compiled": true, "compiled_code": "with customers as (\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__customer_details\"\n\n), churn_types as (\n    select \n        customers.*,\n        case when calculated_subscriptions_active_count > 0 and has_valid_payment_method = true\n            then false else true\n            end as is_churned,\n        \n        case when calculated_subscriptions_active_count = 0 and has_valid_payment_method = false\n            then 'passive cancellation'\n        when calculated_subscriptions_active_count = 0 and has_valid_payment_method = true\n            then 'active cancellation'\n        when calculated_subscriptions_active_count > 0 and has_valid_payment_method = false\n            then 'charge error'\n        else cast(null as TEXT)\n        end as churn_type\n    from customers\n)\n\nselect *\nfrom churn_type", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.940203Z", "completed_at": "2024-08-06T00:26:17.947245Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.948004Z", "completed_at": "2024-08-06T00:26:17.948012Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013028144836425781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge.not_null_recharge__customer_details_customer_id.598dec46b9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__customer_details\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.942776Z", "completed_at": "2024-08-06T00:26:17.947805Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:17.948484Z", "completed_at": "2024-08-06T00:26:17.948488Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.013243913650512695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge.unique_recharge__customer_details_customer_id.bc46ecdbae", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__customer_details\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:17.949550Z", "completed_at": "2024-08-06T00:26:18.022364Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:18.022645Z", "completed_at": "2024-08-06T00:26:18.022654Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07363390922546387, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge.recharge__customer_daily_rollup", "compiled": true, "compiled_code": "with  __dbt__cte__int_recharge__customer_daily_rollup as (\nwith calendar as (\n    select *\n    from \"postgres\".\"recharge_integration_tests_03_recharge\".\"int_recharge__calendar_spine\"\n\n), customers as (\n    select \n        customer_id, \n        customer_created_at\n    from \"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__customer_details\"\n\n), customers_dates as (\n    select \n        customers.customer_id,\n        calendar.date_day,\n        cast(date_trunc('week', calendar.date_day) as date) as date_week,\n        cast(date_trunc('month', calendar.date_day) as date) as date_month,\n        cast(date_trunc('year', calendar.date_day) as date) as date_year\n    from calendar\n    cross join customers\n    where cast(date_trunc('day', customers.customer_created_at) as date) <= calendar.date_day\n)\n\nselect *\nfrom customers_dates\n), spine as (\n    select *\n    from __dbt__cte__int_recharge__customer_daily_rollup\n\n), billing as (\n    select \n        *,\n        case when lower(order_type) = 'recurring' and lower(order_status) not in ('error', 'cancelled', 'queued') \n            then charge_total_price - charge_total_refunds\n            else 0 end as charge_recurring_net_amount,\n        case when lower(order_type) = 'checkout' and lower(order_status) not in ('error', 'cancelled', 'queued')\n            then charge_total_price - charge_total_refunds\n            else 0 end as charge_one_time_net_amount,\n        case when lower(order_type) = 'recurring' and lower(order_status) not in ('error', 'cancelled', 'queued') \n            then calculated_order_total_price - calculated_order_total_refunds\n            else 0 end as calculated_order_recurring_net_amount,\n        case when lower(order_type) = 'checkout' and lower(order_status) not in ('error', 'cancelled', 'queued')\n            then calculated_order_total_price - calculated_order_total_refunds\n            else 0 end as calculated_order_one_time_net_amount\n    from \"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__billing_history\"\n\n), customers as (\n    select \n        customer_id,\n        first_charge_processed_at\n    from \"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__customer_details\"\n\n), aggs as (\n    select\n        spine.customer_id,\n        spine.date_day,\n        spine.date_week,\n        spine.date_month,\n        spine.date_year,\n        count(billing.order_id) as no_of_orders,\n        count(case when lower(billing.order_type) = 'recurring' then 1 else null end) as recurring_orders,\n        count(case when lower(billing.order_type) = 'checkout' then 1 else null end) as one_time_orders,\n        coalesce(sum(billing.charge_total_price), 0) as total_charges,\n        \n        \n            round(cast(sum(case when lower(billing.order_status)  not in ('error', 'cancelled', 'queued')\n                then billing.charge_total_price else 0 end) as numeric(28,6)), 2)\n                as charge_total_price_realized\n            ,\n            round(cast(sum(case when lower(billing.order_status)  not in ('error', 'cancelled', 'queued')\n                then billing.charge_total_discounts else 0 end) as numeric(28,6)), 2)\n                as charge_total_discounts_realized\n            ,\n            round(cast(sum(case when lower(billing.order_status)  not in ('error', 'cancelled', 'queued')\n                then billing.charge_total_tax else 0 end) as numeric(28,6)), 2)\n                as charge_total_tax_realized\n            ,\n            round(cast(sum(case when lower(billing.order_status)  not in ('error', 'cancelled', 'queued')\n                then billing.charge_total_refunds else 0 end) as numeric(28,6)), 2)\n                as charge_total_refunds_realized\n            ,\n            round(cast(sum(case when lower(billing.order_status)  not in ('error', 'cancelled', 'queued')\n                then billing.calculated_order_total_discounts else 0 end) as numeric(28,6)), 2)\n                as calculated_order_total_discounts_realized\n            ,\n            round(cast(sum(case when lower(billing.order_status)  not in ('error', 'cancelled', 'queued')\n                then billing.calculated_order_total_tax else 0 end) as numeric(28,6)), 2)\n                as calculated_order_total_tax_realized\n            ,\n            round(cast(sum(case when lower(billing.order_status)  not in ('error', 'cancelled', 'queued')\n                then billing.calculated_order_total_price else 0 end) as numeric(28,6)), 2)\n                as calculated_order_total_price_realized\n            ,\n            round(cast(sum(case when lower(billing.order_status)  not in ('error', 'cancelled', 'queued')\n                then billing.calculated_order_total_refunds else 0 end) as numeric(28,6)), 2)\n                as calculated_order_total_refunds_realized\n            ,\n            round(cast(sum(case when lower(billing.order_status)  not in ('error', 'cancelled', 'queued')\n                then billing.order_line_item_total else 0 end) as numeric(28,6)), 2)\n                as order_line_item_total_realized\n            ,\n            round(cast(sum(case when lower(billing.order_status)  not in ('error', 'cancelled', 'queued')\n                then billing.order_item_quantity else 0 end) as numeric(28,6)), 2)\n                as order_item_quantity_realized\n            ,\n            round(cast(sum(case when lower(billing.order_status)  not in ('error', 'cancelled', 'queued')\n                then billing.charge_recurring_net_amount else 0 end) as numeric(28,6)), 2)\n                as charge_recurring_net_amount_realized\n            ,\n            round(cast(sum(case when lower(billing.order_status)  not in ('error', 'cancelled', 'queued')\n                then billing.charge_one_time_net_amount else 0 end) as numeric(28,6)), 2)\n                as charge_one_time_net_amount_realized\n            ,\n            round(cast(sum(case when lower(billing.order_status)  not in ('error', 'cancelled', 'queued')\n                then billing.calculated_order_recurring_net_amount else 0 end) as numeric(28,6)), 2)\n                as calculated_order_recurring_net_amount_realized\n            ,\n            round(cast(sum(case when lower(billing.order_status)  not in ('error', 'cancelled', 'queued')\n                then billing.calculated_order_one_time_net_amount else 0 end) as numeric(28,6)), 2)\n                as calculated_order_one_time_net_amount_realized\n            \n    from spine\n    left join billing\n        on cast(date_trunc('day', billing.order_processed_at) as date) = spine.date_day\n        and billing.customer_id = spine.customer_id\n    group by 1,2,3,4,5\n\n), aggs_running as (\n    select\n        *,\n        \n            round(cast(sum(charge_total_price_realized) over (partition by customer_id order by date_day asc \n                rows unbounded preceding) as numeric(28,6)), 2)\n                as charge_total_price_running_total\n            ,\n            round(cast(sum(charge_total_discounts_realized) over (partition by customer_id order by date_day asc \n                rows unbounded preceding) as numeric(28,6)), 2)\n                as charge_total_discounts_running_total\n            ,\n            round(cast(sum(charge_total_tax_realized) over (partition by customer_id order by date_day asc \n                rows unbounded preceding) as numeric(28,6)), 2)\n                as charge_total_tax_running_total\n            ,\n            round(cast(sum(charge_total_refunds_realized) over (partition by customer_id order by date_day asc \n                rows unbounded preceding) as numeric(28,6)), 2)\n                as charge_total_refunds_running_total\n            ,\n            round(cast(sum(calculated_order_total_discounts_realized) over (partition by customer_id order by date_day asc \n                rows unbounded preceding) as numeric(28,6)), 2)\n                as calculated_order_total_discounts_running_total\n            ,\n            round(cast(sum(calculated_order_total_tax_realized) over (partition by customer_id order by date_day asc \n                rows unbounded preceding) as numeric(28,6)), 2)\n                as calculated_order_total_tax_running_total\n            ,\n            round(cast(sum(calculated_order_total_price_realized) over (partition by customer_id order by date_day asc \n                rows unbounded preceding) as numeric(28,6)), 2)\n                as calculated_order_total_price_running_total\n            ,\n            round(cast(sum(calculated_order_total_refunds_realized) over (partition by customer_id order by date_day asc \n                rows unbounded preceding) as numeric(28,6)), 2)\n                as calculated_order_total_refunds_running_total\n            ,\n            round(cast(sum(order_line_item_total_realized) over (partition by customer_id order by date_day asc \n                rows unbounded preceding) as numeric(28,6)), 2)\n                as order_line_item_total_running_total\n            ,\n            round(cast(sum(order_item_quantity_realized) over (partition by customer_id order by date_day asc \n                rows unbounded preceding) as numeric(28,6)), 2)\n                as order_item_quantity_running_total\n            ,\n            round(cast(sum(charge_recurring_net_amount_realized) over (partition by customer_id order by date_day asc \n                rows unbounded preceding) as numeric(28,6)), 2)\n                as charge_recurring_net_amount_running_total\n            ,\n            round(cast(sum(charge_one_time_net_amount_realized) over (partition by customer_id order by date_day asc \n                rows unbounded preceding) as numeric(28,6)), 2)\n                as charge_one_time_net_amount_running_total\n            ,\n            round(cast(sum(calculated_order_recurring_net_amount_realized) over (partition by customer_id order by date_day asc \n                rows unbounded preceding) as numeric(28,6)), 2)\n                as calculated_order_recurring_net_amount_running_total\n            ,\n            round(cast(sum(calculated_order_one_time_net_amount_realized) over (partition by customer_id order by date_day asc \n                rows unbounded preceding) as numeric(28,6)), 2)\n                as calculated_order_one_time_net_amount_running_total\n            \n    from aggs\n\n), active_months as (\n    select\n        aggs_running.*,\n        round(cast(\n        ((aggs_running.date_day)::date - (customers.first_charge_processed_at)::date)\n     / 30 \n            as numeric(28,6)), 2)\n            as active_months_to_date\n    from aggs_running\n    left join customers\n        on customers.customer_id = aggs_running.customer_id\n)\n\nselect * \nfrom active_months", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__customer_daily_rollup\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:18.028161Z", "completed_at": "2024-08-06T00:26:18.032237Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:18.032745Z", "completed_at": "2024-08-06T00:26:18.032752Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00844430923461914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge.dbt_utils_unique_combination_of_columns_recharge__customer_daily_rollup_customer_id__date_day.6ac34efe6c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        customer_id, date_day\n    from \"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__customer_daily_rollup\"\n    group by customer_id, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:18.025042Z", "completed_at": "2024-08-06T00:26:18.032483Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:18.033176Z", "completed_at": "2024-08-06T00:26:18.033180Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009153127670288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.recharge.recharge__monthly_recurring_revenue", "compiled": true, "compiled_code": "with aggs as (\n    select \n        date_month,\n        customer_id,\n        sum(recurring_orders) as recurring_orders,\n        round(cast(sum(charge_recurring_net_amount_realized) as numeric(28,6)), 2) as total_net_recurring_charges,\n        round(cast(sum(calculated_order_recurring_net_amount_realized) as numeric(28,6)), 2) as calculated_net_order_mrr,\n        sum(one_time_orders) as one_time_orders,\n        round(cast(sum(charge_one_time_net_amount_realized) as numeric(28,6)), 2) as total_net_one_time_charges,\n        round(cast(sum(calculated_order_one_time_net_amount_realized) as numeric(28,6)), 2) as calculated_net_order_one_times\n    from \"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__customer_daily_rollup\"\n    group by 1,2\n)\n\nselect *\nfrom aggs", "relation_name": "\"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__monthly_recurring_revenue\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T00:26:18.034814Z", "completed_at": "2024-08-06T00:26:18.039068Z"}, {"name": "execute", "started_at": "2024-08-06T00:26:18.039313Z", "completed_at": "2024-08-06T00:26:18.039320Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005135059356689453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.recharge.dbt_utils_unique_combination_of_columns_recharge__monthly_recurring_revenue_customer_id__date_month.05cb3c9e75", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        customer_id, date_month\n    from \"postgres\".\"recharge_integration_tests_03_recharge\".\"recharge__monthly_recurring_revenue\"\n    group by customer_id, date_month\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}], "elapsed_time": 2.996239185333252, "args": {"indirect_selection": "eager", "defer": false, "quiet": false, "static_parser": true, "printer_width": 80, "favor_state": false, "profiles_dir": "/Users/joseph.markiewicz/.dbt", "compile": true, "send_anonymous_usage_stats": true, "require_explicit_package_overrides_for_builtin_materializations": true, "partial_parse": true, "exclude": [], "log_path": "/Users/joseph.markiewicz/Documents/dbt_packages/standardized_models/billing/dbt_recharge/integration_tests/logs", "empty_catalog": false, "introspect": true, "strict_mode": false, "version_check": true, "vars": {}, "log_format": "default", "log_format_file": "debug", "invocation_command": "dbt docs generate -t postgres", "write_json": true, "log_level": "info", "select": [], "require_resource_names_without_spaces": false, "macro_debugging": false, "show_resource_report": false, "log_level_file": "debug", "use_colors_file": true, "print": true, "warn_error_options": {"include": [], "exclude": []}, "partial_parse_file_diff": true, "populate_cache": true, "log_file_max_bytes": 10485760, "source_freshness_run_project_hooks": false, "target": "postgres", "which": "generate", "cache_selected_only": false, "static": false, "enable_legacy_logger": false, "use_colors": true, "project_dir": "/Users/joseph.markiewicz/Documents/dbt_packages/standardized_models/billing/dbt_recharge/integration_tests"}}